summarise(caligus = mean(all.cal))
calboot.pink2016D[i,] <- res[]
}
for(i in 1:10000) {
b1 <- sample(pink2016J$Collection, size = 1)
res <- pink2016J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(caligus = mean(all.cal))
calboot.pink2016J[i,] <- res[]
}
for(i in 1:10000) {
b1 <- sample(pink2017D$Collection, size = 1)
res <- pink2017D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(caligus = mean(all.cal))
calboot.pink2017D[i,] <- res[]
}
for(i in 1:10000) {
b1 <- sample(pink2017J$Collection, size = 1)
res <- pink2017J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(caligus = mean(all.cal))
calboot.pink2017J[i,] <- res[]
}
for(i in 1:10000) {
b1 <- sample(pink2018D$Collection, size = 1)
res <- pink2018D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(caligus = mean(all.cal))
calboot.pink2018D[i,] <- res[]
}
for(i in 1:10000) {
b1 <- sample(pink2018J$Collection, size = 1)
res <- pink2018J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(caligus = mean(all.cal))
calboot.pink2018J[i,] <- res[]
}
#Now the leps
#first, make empty dataframes for the results
lepboot.sock2015D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2015D) <- c('Collection', 'Leps')
lepboot.sock2015J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2015J) <- c('Collection', 'Leps')
lepboot.sock2016D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2016D) <- c('Collection', 'Leps')
lepboot.sock2016J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2016J) <- c('Collection', 'Leps')
lepboot.sock2017D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2017D) <- c('Collection', 'Leps')
lepboot.sock2017J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2017J) <- c('Collection', 'Leps')
lepboot.sock2018D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2018D) <- c('Collection', 'Leps')
lepboot.sock2018J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.sock2018J) <- c('Collection', 'Leps')
lepboot.chum2015D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2015D) <- c('Collection', 'Leps')
lepboot.chum2015J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2015J) <- c('Collection', 'Leps')
lepboot.chum2016D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2016D) <- c('Collection', 'Leps')
lepboot.chum2016J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2016J) <- c('Collection', 'Leps')
lepboot.chum2017D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2017D) <- c('Collection', 'Leps')
lepboot.chum2017J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2017J) <- c('Collection', 'Leps')
lepboot.chum2018D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2018D) <- c('Collection', 'Leps')
lepboot.chum2018J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.chum2018J) <- c('Collection', 'Leps')
lepboot.pink2015D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2015D) <- c('Collection', 'Leps')
lepboot.pink2015J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2015J) <- c('Collection', 'Leps')
lepboot.pink2016D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2016D) <- c('Collection', 'Leps')
lepboot.pink2016J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2016J) <- c('Collection', 'Leps')
lepboot.pink2017D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2017D) <- c('Collection', 'Leps')
lepboot.pink2017J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2017J) <- c('Collection', 'Leps')
lepboot.pink2018D <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2018D) <- c('Collection', 'Leps')
lepboot.pink2018J <- data.frame(nrow = 10000, ncol = 2); colnames(lepboot.pink2018J) <- c('Collection', 'Leps')
#we'll use a loop as well as dplyr::sample_n()Leps
#sockeye
pb = txtProgressBar(min = 0, max = 10000, initial = 0)
for(i in 1:10000) {
b1 <- sample(sock2015D$Collection, size = 1)
res <- sock2015D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2015D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2015J$Collection, size = 1)
res <- sock2015J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2015J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2016D$Collection, size = 1)
res <- sock2016D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2016D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2016J$Collection, size = 1)
res <- sock2016J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2016J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2017D$Collection, size = 1)
res <- sock2017D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2017D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2017J$Collection, size = 1)
res <- sock2017J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2017J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2018D$Collection, size = 1)
res <- sock2018D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2018D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(sock2018J$Collection, size = 1)
res <- sock2018J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.sock2018J[i,] <- res[]
setTxtProgressBar(pb,i)
}
#chum
for(i in 1:10000) {
b1 <- sample(chum2015D$Collection, size = 1)
res <- chum2015D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2015D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2015J$Collection, size = 1)
res <- chum2015J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2015J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2016D$Collection, size = 1)
res <- chum2016D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2016D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2016J$Collection, size = 1)
res <- chum2016J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2016J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2017D$Collection, size = 1)
res <- chum2017D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2017D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2017J$Collection, size = 1)
res <- chum2017J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2017J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2018D$Collection, size = 1)
res <- chum2018D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2018D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(chum2018J$Collection, size = 1)
res <- chum2018J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.chum2018J[i,] <- res[]
setTxtProgressBar(pb,i)
}
#pink
for(i in 1:10000) {
b1 <- sample(pink2015D$Collection, size = 1)
res <- pink2015D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2015D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2015J$Collection, size = 1)
res <- pink2015J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2015J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2016D$Collection, size = 1)
res <- pink2016D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2016D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2016J$Collection, size = 1)
res <- pink2016J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2016J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2017D$Collection, size = 1)
res <- pink2017D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2017D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2017J$Collection, size = 1)
res <- pink2017J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2017J[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2018D$Collection, size = 1)
res <- pink2018D %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2018D[i,] <- res[]
setTxtProgressBar(pb,i)
}
for(i in 1:10000) {
b1 <- sample(pink2018J$Collection, size = 1)
res <- pink2018J %>%
group_by(Collection) %>%
filter(Collection == b1) %>%
sample_n(n(), ufn, replace = TRUE) %>%
summarise(leps = mean(all.leps))
lepboot.pink2018J[i,] <- res[]
setTxtProgressBar(pb,i)
}
#now we're going to plot all this
#first thing is to sort the dataframes (based on value of the bootstraps)
#and pick the 5000th (estimate), 9750th (upper confidence), and 250th (lower confidence) values
#cals
calboot.sock2015D <- calboot.sock2015D[order(calboot.sock2015D$Caligus),]
calboot.sock2015J <- calboot.sock2015J[order(calboot.sock2015J$Caligus),]
calboot.sock2016D <- calboot.sock2016D[order(calboot.sock2016D$Caligus),]
calboot.sock2016J <- calboot.sock2016J[order(calboot.sock2016J$Caligus),]
calboot.sock2017D <- calboot.sock2017D[order(calboot.sock2017D$Caligus),]
calboot.sock2017J <- calboot.sock2017J[order(calboot.sock2017J$Caligus),]
calboot.sock2018D <- calboot.sock2018D[order(calboot.sock2018D$Caligus),]
calboot.sock2018J <- calboot.sock2018J[order(calboot.sock2018J$Caligus),]
calboot.chum2015D <- calboot.chum2015D[order(calboot.chum2015D$Caligus),]
calboot.chum2015J <- calboot.chum2015J[order(calboot.chum2015J$Caligus),]
calboot.chum2016D <- calboot.chum2016D[order(calboot.chum2016D$Caligus),]
calboot.chum2016J <- calboot.chum2016J[order(calboot.chum2016J$Caligus),]
calboot.chum2017D <- calboot.chum2017D[order(calboot.chum2017D$Caligus),]
calboot.chum2017J <- calboot.chum2017J[order(calboot.chum2017J$Caligus),]
calboot.chum2018D <- calboot.chum2018D[order(calboot.chum2018D$Caligus),]
calboot.chum2018J <- calboot.chum2018J[order(calboot.chum2018J$Caligus),]
calboot.pink2015D <- calboot.pink2015D[order(calboot.pink2015D$Caligus),]
calboot.pink2015J <- calboot.pink2015J[order(calboot.pink2015J$Caligus),]
calboot.pink2016D <- calboot.pink2016D[order(calboot.pink2016D$Caligus),]
calboot.pink2016J <- calboot.pink2016J[order(calboot.pink2016J$Caligus),]
calboot.pink2017D <- calboot.pink2017D[order(calboot.pink2017D$Caligus),]
calboot.pink2017J <- calboot.pink2017J[order(calboot.pink2017J$Caligus),]
calboot.pink2018D <- calboot.pink2018D[order(calboot.pink2018D$Caligus),]
calboot.pink2018J <- calboot.pink2018J[order(calboot.pink2018J$Caligus),]
#leps
lepboot.sock2015D <- lepboot.sock2015D[order(lepboot.sock2015D$Leps),]
lepboot.sock2015J <- lepboot.sock2015J[order(lepboot.sock2015J$Leps),]
lepboot.sock2016D <- lepboot.sock2016D[order(lepboot.sock2016D$Leps),]
lepboot.sock2016J <- lepboot.sock2016J[order(lepboot.sock2016J$Leps),]
lepboot.sock2017D <- lepboot.sock2017D[order(lepboot.sock2017D$Leps),]
lepboot.sock2017J <- lepboot.sock2017J[order(lepboot.sock2017J$Leps),]
lepboot.sock2018D <- lepboot.sock2018D[order(lepboot.sock2018D$Leps),]
lepboot.sock2018J <- lepboot.sock2018J[order(lepboot.sock2018J$Leps),]
lepboot.chum2015D <- lepboot.chum2015D[order(lepboot.chum2015D$Leps),]
lepboot.chum2015J <- lepboot.chum2015J[order(lepboot.chum2015J$Leps),]
lepboot.chum2016D <- lepboot.chum2016D[order(lepboot.chum2016D$Leps),]
lepboot.chum2016J <- lepboot.chum2016J[order(lepboot.chum2016J$Leps),]
lepboot.chum2017D <- lepboot.chum2017D[order(lepboot.chum2017D$Leps),]
lepboot.chum2017J <- lepboot.chum2017J[order(lepboot.chum2017J$Leps),]
lepboot.chum2018D <- lepboot.chum2018D[order(lepboot.chum2018D$Leps),]
lepboot.chum2018J <- lepboot.chum2018J[order(lepboot.chum2018J$Leps),]
lepboot.pink2015D <- lepboot.pink2015D[order(lepboot.pink2015D$Leps),]
lepboot.pink2015J <- lepboot.pink2015J[order(lepboot.pink2015J$Leps),]
lepboot.pink2016D <- lepboot.pink2016D[order(lepboot.pink2016D$Leps),]
lepboot.pink2016J <- lepboot.pink2016J[order(lepboot.pink2016J$Leps),]
lepboot.pink2017D <- lepboot.pink2017D[order(lepboot.pink2017D$Leps),]
lepboot.pink2017J <- lepboot.pink2017J[order(lepboot.pink2017J$Leps),]
lepboot.pink2018D <- lepboot.pink2018D[order(lepboot.pink2018D$Leps),]
lepboot.pink2018J <- lepboot.pink2018J[order(lepboot.pink2018J$Leps),]
#now put the data in a format I can use to plot it all
#make the ones that will go in each df
sal1 <- c('Chum','Chum','Chum','Chum','Chum','Chum','Chum','Chum')
sal2 <- c('Pink','Pink','Pink','Pink','Pink','Pink','Pink','Pink')
sal3 <- c('Sockeye','Sockeye','Sockeye','Sockeye','Sockeye','Sockeye','Sockeye','Sockeye')
year <- c('2015','2015','2016','2016','2017','2017','2018','2018')
Region<- c('DI','JS','DI','JS','DI','JS','DI','JS')
lice1 <- c('C. clemensi', 'C. clemensi','C. clemensi', 'C. clemensi',
'C. clemensi', 'C. clemensi','C. clemensi', 'C. clemensi')
lice2 <- c('L. salmonis', 'L. salmonis', 'L. salmonis', 'L. salmonis',
'L. salmonis', 'L. salmonis', 'L. salmonis', 'L. salmonis')
#make the main dfs calling the indexes I want from the bootstrapped dfs
#chum caligus
boot.chumcalcoeffs<-c(calboot.chum2015D[5000,2],calboot.chum2015J[5000,2], calboot.chum2016D[5000,2], calboot.chum2016J[5000,2],
calboot.chum2017D[5000,2],calboot.chum2017J[5000,2], calboot.chum2018D[5000,2], calboot.chum2018J[5000,2])
boot.chumcalupCI <- c(calboot.chum2015D[9750,2],calboot.chum2015J[9750,2], calboot.chum2016D[9750,2], calboot.chum2016J[9750,2],
calboot.chum2017D[9750,2],calboot.chum2017J[9750,2], calboot.chum2018D[9750,2], calboot.chum2018J[9750,2])
boot.chumcalloCI <- c(calboot.chum2015D[250,2], calboot.chum2015J[250,2],  calboot.chum2016D[250,2],  calboot.chum2016J[250,2],
calboot.chum2017D[250,2], calboot.chum2017J[250,2],  calboot.chum2018D[250,2],  calboot.chum2018J[250,2])
boot.chumsregioncal <- rename(data.frame(boot.chumcalcoeffs,boot.chumcalupCI,boot.chumcalloCI,sal1,year,Region,lice1),
coeffs = boot.chumcalcoeffs, upCI = boot.chumcalupCI, loCI = boot.chumcalloCI,
lice = lice1, sal = sal1)
#chum leps
boot.chumlepcoeffs<-c(lepboot.chum2015D[5000,2], lepboot.chum2015J[5000,2], lepboot.chum2016D[5000,2], lepboot.chum2016J[5000,2],
lepboot.chum2017D[5000,2], lepboot.chum2017J[5000,2], lepboot.chum2018D[5000,2], lepboot.chum2018J[5000,2])
boot.chumlepupCI <- c(lepboot.chum2015D[9750,2], lepboot.chum2015J[9750,2], lepboot.chum2016D[9750,2], lepboot.chum2016J[9750,2],
lepboot.chum2017D[9750,2], lepboot.chum2017J[9750,2], lepboot.chum2018D[9750,2], lepboot.chum2018J[9750,2])
boot.chumleploCI <- c(lepboot.chum2015D[250,2],  lepboot.chum2015J[250,2],  lepboot.chum2016D[250,2],  lepboot.chum2016J[250,2],
lepboot.chum2017D[250,2],  lepboot.chum2017J[250,2],  lepboot.chum2018D[250,2],  lepboot.chum2018J[250,2])
boot.chumsregionlep <- rename(data.frame(boot.chumlepcoeffs,boot.chumlepupCI,boot.chumleploCI,sal1,year,Region,lice2),
coeffs = boot.chumlepcoeffs, upCI = boot.chumlepupCI, loCI = boot.chumleploCI,
sal = sal1, lice = lice2)
#pink caligus
boot.pinkcalcoeffs<-c(calboot.pink2015D[5000,2], calboot.pink2015J[5000,2], calboot.pink2016D[5000,2], calboot.pink2016J[5000,2],
calboot.pink2017D[5000,2], calboot.pink2017J[5000,2], calboot.pink2018D[5000,2], calboot.pink2018J[5000,2])
boot.pinkcalupCI <- c(calboot.pink2015D[9750,2], calboot.pink2015J[9750,2], calboot.pink2016D[9750,2], calboot.pink2016J[9750,2],
calboot.pink2017D[9750,2], calboot.pink2017J[9750,2], calboot.pink2018D[9750,2], calboot.pink2018J[9750,2])
boot.pinkcalloCI <- c(calboot.pink2015D[250,2],  calboot.pink2015J[250,2],  calboot.pink2016D[250,2],  calboot.pink2016J[250,2],
calboot.pink2017D[250,2],  calboot.pink2017J[250,2],  calboot.pink2018D[250,2],  calboot.pink2018J[250,2])
boot.pinkregioncal <- rename(data.frame(boot.pinkcalcoeffs,boot.pinkcalupCI,boot.pinkcalloCI,sal2,year,Region,lice1),
coeffs = boot.pinkcalcoeffs, upCI = boot.pinkcalupCI, loCI = boot.pinkcalloCI,
sal = sal2, lice = lice1)
#pink leps
boot.pinklepscoeffs<-c(lepboot.pink2015D[5000,2], lepboot.pink2015J[5000,2], lepboot.pink2016D[5000,2], lepboot.pink2016J[5000,2],
lepboot.pink2017D[5000,2], lepboot.pink2017J[5000,2], lepboot.pink2018D[5000,2], lepboot.pink2018J[5000,2])
boot.pinklepsupCI <- c(lepboot.pink2015D[9750,2], lepboot.pink2015J[9750,2], lepboot.pink2016D[9750,2], lepboot.pink2016J[9750,2],
lepboot.pink2017D[9750,2], lepboot.pink2017J[9750,2], lepboot.pink2018D[9750,2], lepboot.pink2018J[9750,2])
boot.pinklepsloCI <- c(lepboot.pink2015D[250,2],  lepboot.pink2015J[250,2],  lepboot.pink2016D[250,2],  lepboot.pink2016J[250,2],
lepboot.pink2017D[250,2],  lepboot.pink2017J[250,2],  lepboot.pink2018D[250,2],  lepboot.pink2018J[250,2])
boot.pinkregionleps <- rename(data.frame(boot.pinklepscoeffs,boot.pinklepsupCI,boot.pinklepsloCI,sal2,year,Region,lice2),
coeffs = boot.pinklepscoeffs, upCI = boot.pinklepsupCI, loCI =  boot.pinklepsloCI,
sal = sal2, lice = lice2)
#sockeye caligus
boot.sockcalcoeffs<-c(calboot.sock2015D[5000,2], calboot.sock2015J[5000,2], calboot.sock2016D[5000,2], calboot.sock2016J[5000,2],
calboot.sock2017D[5000,2], calboot.sock2017J[5000,2], calboot.sock2018D[5000,2], calboot.sock2018J[5000,2])
boot.sockcalupCI <- c(calboot.sock2015D[9750,2], calboot.sock2015J[9750,2], calboot.sock2016D[9750,2], calboot.sock2016J[9750,2],
calboot.sock2017D[9750,2], calboot.sock2017J[9750,2], calboot.sock2018D[9750,2], calboot.sock2018J[9750,2])
boot.sockcalloCI <- c(calboot.sock2015D[250,2],  calboot.sock2015J[250,2],  calboot.sock2016D[250,2],  calboot.sock2016J[250,2],
calboot.sock2017D[250,2],  calboot.sock2017J[250,2],  calboot.sock2018D[250,2],  calboot.sock2018J[250,2])
boot.sockregioncal <- rename(data.frame(boot.sockcalcoeffs,boot.sockcalupCI,boot.sockcalloCI,sal3,year,Region,lice1),
coeffs = boot.sockcalcoeffs, upCI = boot.sockcalupCI, loCI = boot.sockcalloCI,
sal = sal3, lice = lice1)
#sockeye leps
boot.socklepscoeffs<-c(lepboot.sock2015D[5000,2], lepboot.sock2015J[5000,2], lepboot.sock2016D[5000,2], lepboot.sock2016J[5000,2],
lepboot.sock2017D[5000,2], lepboot.sock2017J[5000,2], lepboot.sock2018D[5000,2], lepboot.sock2018J[5000,2])
boot.socklepsupCI <- c(lepboot.sock2015D[9750,2], lepboot.sock2015J[9750,2], lepboot.sock2016D[9750,2], lepboot.sock2016J[9750,2],
lepboot.sock2017D[9750,2], lepboot.sock2017J[9750,2], lepboot.sock2018D[9750,2], lepboot.sock2018J[9750,2])
boot.socklepsloCI <- c(lepboot.sock2015D[250,2],  lepboot.sock2015J[250,2],  lepboot.sock2016D[250,2],  lepboot.sock2016J[250,2],
lepboot.sock2017D[250,2],  lepboot.sock2017J[250,2],  lepboot.sock2018D[250,2],  lepboot.sock2018J[250,2])
boot.sockregionleps <- rename(data.frame(boot.socklepscoeffs,boot.socklepsupCI,boot.socklepsloCI,sal3,year,Region,lice2),
coeffs = boot.socklepscoeffs, upCI = boot.socklepsupCI, loCI = boot.socklepsloCI,
sal = sal3, lice = lice2)
boot.regionestbyspchum <- rbind(boot.chumsregioncal, boot.chumsregionlep)
boot.regionestbysppink <- rbind(boot.pinkregioncal, boot.pinkregionleps)
boot.regionestbyspsock <- rbind(boot.sockregioncal, boot.sockregionleps)
#make the plots
boot.regionestbyspplotchum <- boot.regionestbyspchum %>%
group_by(.,lice,Region,year) %>%
ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
geom_point(size = 4, position = position_dodge(width=0.8)) +
facet_wrap(~year, nrow=1, strip.position = 'bottom')+
scale_color_manual(values=c('grey60', 'grey20'))+
labs(title = "Chum Salmon",x = '', y = NULL,shape = 'Lice Species')+
guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
scale_y_continuous(limits = c(0,3.0)) +
fte_themeChum()
boot.regionestbyspplotchum
boot.regionestbyspplotpink <- boot.regionestbysppink %>%
group_by(.,lice,Region,year) %>%
ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
geom_point(size = 4, position = position_dodge(width=0.8)) +
facet_wrap(~year, nrow=1, strip.position = 'bottom')+
theme(strip.background = element_blank(),strip.placement = 'outside') +
scale_color_manual(values=c('grey60', 'grey20'))+
labs(title = "Pink Salmon", x = 'Year & Region', y = NULL,shape = 'Lice Species')+
guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
scale_y_continuous(limits = c(0,3.0)) +
fte_themePink()
boot.regionestbyspplotpink
boot.regionestbyspplotsock <- boot.regionestbyspsock %>%
group_by(.,lice,Region,year) %>%
ggplot(aes(x=Region, y = coeffs, colour = Region, shape = lice)) +
scale_shape_manual(values = c(17,15),labels = c('C. clemensi','L. salmonis'))+
geom_errorbar(aes(ymin=loCI, ymax = upCI, width = 0), position = position_dodge(width = 0.8),colour = 'Black') +
geom_point(size = 4, position = position_dodge(width=0.8)) +
facet_wrap(~year, nrow=1, strip.position = 'bottom')+
theme(strip.background = element_blank(),strip.placement = 'outside') +
scale_color_manual(values=c('grey60', 'grey20'))+
labs(title = "Sockeye Salmon", x = '', y = 'Bootstrapped Number of Motile Lice per Fish',shape = 'Lice Species')+
guides(shape = guide_legend(override.aes = list(shape = c(24,22)), type = 'b'))+
scale_y_continuous(limits = c(0,3.0))+
fte_themeSock()
boot.regionestbyspplotsock
boot.regionboth <- plot_grid(boot.regionestbyspplotsock,boot.regionestbyspplotpink,boot.regionestbyspplotchum,
nrow = 1, labels = NULL, rel_widths = c(1,1,1))
boot.regionboth
citation(package = 'glmmTMB')
citation(package = 'base')
citation(package = 'ggeffects')
summary(pinkrmod.lepsnb)
summary(pinkrmod.calnb)
summary(chumrmod.lepsnb)
summary(chumrmod.calnb)
summary(sockrmod.calnb)
summary(sockrmod.lepsnb)
summary(sockrmod.lepsnbsr)
chumcalspeffects
exp(-0.8537)
#use the ggeffects package again to get the estimates that will be put inside the df for plotting
chumcalspeffects <- ggpredict(chumrmod.calnb, terms = c('year'))
chumcalspeffects
exp(-0.2677)
exp(-0.5131)
'site.region',
#use the ggeffects package again to get the estimates that will be put inside the df for plotting
chumcalspeffects <- ggpredict(chumrmod.calnb, terms = c('site.region', 'year'))
