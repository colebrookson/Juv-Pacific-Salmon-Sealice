i = 2
bootintervalcal[,i] = calavgpred$avg
bootintervallep[,i] = lepavgpred$avg
library(tidyverse)
library(glmmTMB)
library(ggeffects)
library(DHARMa)
library(MuMIn)
library(cowplot)
library(AICcmodavg)
library(latexpdf)
names(boot_int_cal)
View(bootintervalcal)
str(bootinterval)
interval_cal = read_csv('boot_int_cal.csv')
interval_lep = read_csv('boot_int_lep.csv')
#figure out a way to put them in columns and sort them
names(interval_cal)
int_cal_long = gather(interval_cal, X1:X1000)
?gather
int_cal_long = interval_cal %>%
gather(c(1:24), X1:X1000)
int_cal_long = interval_cal %>%
gather(as.character(c(1:24)), X1:X1000)
#pull the data
interval_cal_long = read_csv('boot_int_cal_long.csv')
interval_lep_long = read_csv('boot_int_lep_long.csv')
View(lepavgpred)
#name the columns, sort them, and transpose them
names_lep = lepavgpred %>%
unite(., col = 'names', sal:yr, sep = '_')
View(names_lep)
names_cal = calavgpred %>%
unite(., col = 'names', sal:yr, sep = '_')
names_lep = as.vector(names_lep$names)
View(names_cal)
names_cal = as.vector(names_cal$names)
colnames(interval_cal_long) = names_cal
colnames(interval_lep_long) = names_lep
View(interval_cal_long)
View(interval_cal_long)
interval_cal_long_sorted <- apply(interval_cal_long,2,sort,decreasing=F)
View(interval_cal_long_sorted)
interval_cal_long_sorted[1000, ] > interval_cal_long_sorted[999, ]
interval_lep_long_sorted <- apply(interval_lep_long,2,sort,decreasing=F)
interval_lep_long_sorted[1000, ] > interval_lep_long_sorted[999, ]
upci_cal = interval_cal_long_sorted[975]
upci_cal = interval_cal_long_sorted[975, ]
loci_cal = interval_cal_long_sorted[025, ]
upci_lep = interval_lep_long_sorted[975, ]
loci_lep = interval_lep_long_sorted[025, ]
View(calavgpred)
View(lepavgpred)
lepavgpred$conf.high = upci_lep
calavgpred$conf.low = loci_lep
View(calavgpred)
#put the up and lo CI's into the df's
calavgpred$conf.high = upci_cal
calavgpred$conf.low = loci_cal
lepavgpred$conf.high = upci_lep
lepavgpred$conf.low = loci_lep
View(lepavgpred)
lepavgpred$conf.low < lepavgpred$avg
lepavgpred$conf.high > lepavgpred$avg
loci_cal = interval_cal_long_sorted[025, ]
upci_lep = interval_lep_long_sorted[975, ]
loci_lep = interval_lep_long_sorted[025, ]
loci_cal = interval_cal_long_sorted[25, ]
upci_lep = interval_lep_long_sorted[975, ]
loci_lep = interval_lep_long_sorted[25, ]
View(interval_lep_long_sorted)
calavgpred$conf.high > calavgpred$avg
calavgpred$conf.low < calavgpred$avg
#Make the plots
leg_title <- 'Salmon Species'
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = predicted, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b'))
lepsmodplot_avg
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b'))
lepsmodplot_avg
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
#Make the plots
fte_themeChum <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
}
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
}
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_line(color="black", size = 0.15)) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_line(color="black", size = 0.15)) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
}
leg_title <- 'Salmon Species'
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "C. clemensi Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
}
leg_title <- 'Salmon Species'
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "C. clemensi Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_text(size = 10, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 10, color = color.axis.text)) +
theme(axis.text.y = element_text(size = 10, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 12, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 12, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 10))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10))
}
leg_title <- 'Salmon Species'
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "C. clemensi Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
View(calplot)
lepsmodplot_avg
calmodplot_avg
lepsmodplot_avg
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 12, color = color.axis.text)) +
theme(axis.text.y = element_text(size = 12, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 14, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 14, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 12))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12))
}
leg_title <- 'Salmon Species'
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
upci_cal = interval_cal_long_sorted[995, ]
loci_cal = interval_cal_long_sorted[5, ]
upci_lep = interval_lep_long_sorted[995, ]
loci_lep = interval_lep_long_sorted[5, ]
#put the up and lo CI's into the df's
calavgpred$conf.high = upci_cal
calavgpred$conf.low = loci_cal
lepavgpred$conf.high = upci_lep
lepavgpred$conf.low = loci_lep
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 12, color = color.axis.text)) +
theme(axis.text.y = element_text(size = 12, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 14, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 14, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 12))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12))
}
leg_title <- 'Salmon Species'
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "L. salmonis Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17)) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('seagreen2', 'hotpink1', 'steelblue2'))+
labs(title = "C. clemensi Effects Plot", x = 'Salmon Species/Year', y = 'Average Number of Motile Lice Per Fish') +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
