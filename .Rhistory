lep7 = glmmTMB(all.leps ~ site.region + year + spp +
spp * site.region +
(1 | collection), data = mainlice, family = nbinom2)
lep8 = glmmTMB(all.leps ~ site.region + year + spp +
spp * site.region + spp * year +
(1 | collection), data = mainlice, family = nbinom2)
cal1 = glmmTMB(all.cal ~ site.region + year + spp +
site.region * year + site.region * spp +
(1 | collection), data = mainlice, family = nbinom2)
cal2 = glmmTMB(all.cal ~ site.region + year + spp +
site.region * year +
(1 | collection), data = mainlice, family = nbinom2)
cal3 = glmmTMB(all.cal ~ site.region + year + spp +
spp * site.region + site.region * year + spp * year +
(1 | collection), data = mainlice, family = nbinom2)
cal4 = glmmTMB(all.cal ~ site.region + year + spp +
spp * year + site.region * year +
(1 | collection), data = mainlice, family = nbinom2)
cal5 = glmmTMB(all.cal ~ site.region + year + spp +
(1 | collection), data = mainlice, family = nbinom2)
cal6 = glmmTMB(all.cal ~ site.region + year + spp +
site.region * year +
(1 | collection), data = mainlice, family = nbinom2)
cal7 = glmmTMB(all.cal ~ site.region + year + spp +
spp * year +
(1 | collection), data = mainlice, family = nbinom2)
cal8 = glmmTMB(all.cal ~ site.region + year + spp +
spp * site.region + spp * year +
(1 | collection), data = mainlice, family = nbinom2)
#get the predictions of the estiamtes
lep1pred <- ggpredict(lep1, terms = c('spp', 'year', 'site.region'))
lep2pred <- ggpredict(lep2, terms = c('spp', 'year', 'site.region'))
lep3pred <- ggpredict(lep3, terms = c('spp', 'year', 'site.region'))
lep4pred <- ggpredict(lep4, terms = c('spp', 'year', 'site.region'))
lep5pred <- ggpredict(lep5, terms = c('spp', 'year', 'site.region'))
lep6pred <- ggpredict(lep6, terms = c('spp', 'year', 'site.region'))
lep7pred <- ggpredict(lep7, terms = c('spp', 'year', 'site.region'))
lep8pred <- ggpredict(lep8, terms = c('spp', 'year', 'site.region'))
cal1pred <- ggpredict(cal1, terms = c('spp', 'year', 'site.region'))
cal2pred <- ggpredict(cal2, terms = c('spp', 'year', 'site.region'))
cal3pred <- ggpredict(cal3, terms = c('spp', 'year', 'site.region'))
cal4pred <- ggpredict(cal4, terms = c('spp', 'year', 'site.region'))
cal5pred <- ggpredict(cal5, terms = c('spp', 'year', 'site.region'))
cal6pred <- ggpredict(cal6, terms = c('spp', 'year', 'site.region'))
cal7pred <- ggpredict(cal7, terms = c('spp', 'year', 'site.region'))
cal8pred <- ggpredict(cal8, terms = c('spp', 'year', 'site.region'))
###start by getting them all in one dataframe with the weights
#pull the predicted values from each one
lepallpred = data.frame(cbind(lep1pred$predicted, lep2pred$predicted, lep3pred$predicted, lep4pred$predicted,
lep5pred$predicted, lep6pred$predicted, lep7pred$predicted, lep8pred$predicted)) %>%
rename(lep1 = X1, lep2 = X2, lep3 = X3, lep4 = X4, lep5 = X5, lep6 = X6, lep7 = X7, lep8 = X8)
calallpred = data.frame(cbind(cal1pred$predicted, cal2pred$predicted, cal3pred$predicted, cal4pred$predicted,
cal5pred$predicted, cal6pred$predicted, cal7pred$predicted, cal8pred$predicted)) %>%
rename(cal1 = X1, cal2 = X2, cal3 = X3, cal4 = X4, cal5 = X5, cal6 = X6, cal7 = X7, cal8 = X8)
#add the weights from the model selection object
lepallpred = lepallpred %>%
mutate(w1 = rep(lepmod.crossed_dredge$weight[1], nrow(lepallpred)),
w2 = rep(lepmod.crossed_dredge$weight[2], nrow(lepallpred)),
w3 = rep(lepmod.crossed_dredge$weight[3], nrow(lepallpred)),
w4 = rep(lepmod.crossed_dredge$weight[4], nrow(lepallpred)),
w5 = rep(lepmod.crossed_dredge$weight[5], nrow(lepallpred)),
w6 = rep(lepmod.crossed_dredge$weight[6], nrow(lepallpred)),
w7 = rep(lepmod.crossed_dredge$weight[7], nrow(lepallpred)),
w8 = rep(lepmod.crossed_dredge$weight[8], nrow(lepallpred)))
calallpred = calallpred %>%
mutate(w1 = rep(calmod.crossed_dredge$weight[1], nrow(calallpred)),
w2 = rep(calmod.crossed_dredge$weight[2], nrow(calallpred)),
w3 = rep(calmod.crossed_dredge$weight[3], nrow(calallpred)),
w4 = rep(calmod.crossed_dredge$weight[4], nrow(calallpred)),
w5 = rep(calmod.crossed_dredge$weight[5], nrow(calallpred)),
w6 = rep(calmod.crossed_dredge$weight[6], nrow(calallpred)),
w7 = rep(calmod.crossed_dredge$weight[7], nrow(calallpred)),
w8 = rep(calmod.crossed_dredge$weight[8], nrow(calallpred)))
#now make averaged predictions!
lepallpred = lepallpred %>%
mutate(lep1w = lep1*w1, lep2w = lep2*w2, lep3w = lep3*w3, lep4w = lep4*w4, lep5w = lep5*w5, lep6w = lep6*w6, lep7w = lep7*w7, lep8w = lep8*w8) %>%
mutate(avg = lep1w + lep2w + lep3w + lep4w + lep5w + lep6w + lep7w + lep8w)
calallpred = calallpred %>%
mutate(cal1w = cal1*w1, cal2w = cal2*w2, cal3w = cal3*w3, cal4w = cal4*w4, cal5w = cal5*w5, cal6w = cal6*w6, cal7w = cal7*w7, cal8w = cal8*w8) %>%
mutate(avg = cal1w + cal2w + cal3w + cal4w + cal5w + cal6w + cal7w + cal8w)
#keep just the averaged predictions and the relevant grouping info
lepavgpred = lepallpred %>%
dplyr::select(avg) %>%
mutate(sal = lep1pred$x, reg = lep1pred$facet, yr = lep1pred$group)
lepavgpred$sal = factor(lepavgpred$sal, levels = c(1, 2, 3), labels = c('CU', 'PI', 'SO'))
calavgpred = calallpred %>%
dplyr::select(avg) %>%
mutate(sal = cal1pred$x, reg = cal1pred$facet, yr = cal1pred$group)
calavgpred$sal = factor(calavgpred$sal, levels = c(1, 2, 3), labels = c('CU', 'PI', 'SO'))
calavgpred = calallpred %>%
dplyr::select(avg) %>%
mutate(sal = cal1pred$x, reg = cal1pred$facet, yr = cal1pred$group)
#keep just the averaged predictions and the relevant grouping info
lepavgpred = lepallpred %>%
dplyr::select(avg) %>%
mutate(sal = lep1pred$x, reg = lep1pred$facet, yr = lep1pred$group)
calavgpred$conf.high = upci_cal
calavgpred$conf.low = loci_cal
lepavgpred$conf.high = upci_lep
lepavgpred$conf.low = loci_lep
#Make the plots
fte_theme1 <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_blank()) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 12, color = color.axis.text)) +
theme(axis.text.y = element_text(size = 12, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 14, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 14, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15)) +
theme(strip.background = element_blank(),
strip.placement = 'outside',
strip.text = element_text(size = 12))+
theme(legend.position = c(0.8,0.82),
legend.text = element_text(size = 12),
legend.title = element_text(size = 12))
}
leg_title <- 'Salmon Species'
lep_y_effects = expression(paste("Mean Number of Motile  ", italic("L. salmonis"), " Per Fish"))
cal_y_effects = expression(paste("Mean Number of Motile  ", italic("C. clemensi"), " Per Fish"))
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('#59AE7F', '#ff9999', '#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = lep_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
lepsmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), position = position_dodge(width = 0.8),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#59AE7F', '#ff9999', '#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
ggsave('model_ests_cal.png', plot = calmodplot_avg, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = NA, height = NA,
dpi = 300, limitsize = TRUE)
fig_3
fig_3 = plot_grid(fig_3_1, fig_3_2, fig_3_3, nrow = 1,
rel_widths = c(1, 0.8, 0.8))
fig_3
fig_3_data = mainlice %>%
group_by(year, spp) %>%
summarize(mean_lice = mean(all.lice))
fig_3_1 = ggplot() +
geom_col(data = (fig_3_data %>% filter(spp == 'PI')), aes(x = year, y = mean_lice),
colour = 'black', fill = '#ff9999', width = 0.7) +
labs(x = 'Year', y = 'Mean Number of Motile Lice Per Fish', title = 'Pink') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.title.y = element_text(size = 15)) +
theme(axis.text.y = element_text(size = 12)) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
scale_y_continuous(limits = c(0.0, 1.15))
fig_3_2 = ggplot() +
geom_col(data = (fig_3_data %>% filter(spp == 'CU')), aes(x = year, y = mean_lice),
colour = 'black', fill = '#59AE7F', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Chum') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
scale_y_continuous(limits = c(0.0, 1.15))
fig_3_3 = ggplot() +
geom_col(data = (fig_3_data %>% filter(spp == 'SO')), aes(x = year, y = mean_lice),
colour = 'black', fill = '#23359d', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Sockeye') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
scale_y_continuous(limits = c(0.0, 1.15))
fig_3 = plot_grid(fig_3_1, fig_3_2, fig_3_3, nrow = 1,
rel_widths = c(1, 0.8, 0.8))
fig_3
insetmap
BC_shp = readOGR('C:/Users/brookson/Documents/GitHub/SalmonWork/SpatialData/COAST_TEST2.shp')
coords <- data.frame(cbind(salmonsites$Xlatitude,salmonsites$Ylongitutde))
colnames(coords) <- c('lat', 'long')
sort(unique(ggplot2::map_data("world")$region))
westcoast <- map_data('canada')
#make two themes, one for the inset, one for the big map
fte_theme_map_small <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_rect(colour = 'black')) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 12, color = color.axis.text, angle = 90)) +
theme(axis.text.y = element_text(size = 12, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 14, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 14, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15))
}
fte_theme_map_big <- function(){
color.background = 'grey75'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill = 'white', color = 'white')) +
theme(plot.background = element_rect(fill=color.background,color = color.background)) +
theme(panel.border = element_rect(colour = 'black')) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(plot.title = element_blank()) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15))
}
#create the two maps
states    <- c('Washington')
provinces <- c("British Columbia")
us <- getData("GADM",country="USA",level=1)
canada <- getData("GADM",country="CAN",level=1)
us.states <- us[us$NAME_1 %in% states,]
ca.provinces <- canada[canada$NAME_1 %in% provinces,]
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")
biggermap
smallermap = ggplot()+
geom_polygon(data=ca.provinces,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-127.0,-125), ylim = c(50,50.75))+
geom_point(data = coords, aes(long,lat), color = 'black', size = 4, shape = 21, fill = 'red3')+
fte_theme_map_small()+
labs(x = 'Longitude', y = 'Latitude')+
annotate("rect", xmin = -125.51, xmax = -125.05, ymin = 50.1, ymax = 50.5, alpha = .65)+
annotate("rect", xmin = -126.9, xmax = -126.55, ymin = 50.45, ymax = 50.7, alpha = .65)+
annotate('text', x= -125.8, y = 50.33, label = 'Discovery Islands', size = 4)+
annotate('text', x = -126.6, y = 50.38, label = 'Johnstone Strait', size = 4)+
annotate('segment',x=-125.8, y=50.302, xend=-125.565, yend=50.27, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")+
annotate('segment',x=-126.6, y=50.4, xend=-126.65, yend=50.44, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")
smallermap
#make the one plot inset with the other
insetmap = ggdraw()+
draw_plot(smallermap) +
draw_plot(biggermap, x=0.105, y=0.161, width=0.5, height=0.3)
insetmap
calmodplot_avg
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = NA, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
fig_3
print(fig_3)
fig_3
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
library(tidyverse)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(), path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(),
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figureslice_per_fish_sp.png',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(),
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(),
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp',
scale = 1, width = 7.5, height = NA,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3, device = png(),
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
fig_3 = plot_grid(fig_3_1, fig_3_2, fig_3_3, nrow = 1,
rel_widths = c(1, 0.8, 0.8),
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3,
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3,
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('./Figures/lice_per_fish_sp.png', plot = fig_3,
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png', plot = fig_3,
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png', plot = fig_3,
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/,
ggsave('C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png', plot = fig_3,
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png', plot = fig_3,
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('C:/Users/brookson/Documents/GitHub/SalmonWork/Figures/lice_per_fish_sp.png', plot = fig_3,
path = 'C:/Users/brookson/Documents/GitHub/SalmonWork/Figures',
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3,
scale = 1, width = 7.5, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish_sp.png', plot = fig_3,
scale = 1, width = 8, height = 6.7,
dpi = 300, limitsize = TRUE)
fig_2
fig_3
fig_2_6
fig_2
ggsave('lice_per_fish.png', plot = fig_2,
scale = 1, width = 8, height = 6.7,
dpi = 300, limitsize = TRUE)
ggsave('lice_per_fish.png', plot = fig_2,
scale = 1, width = 8, height = 7.5,
dpi = 300, limitsize = TRUE)
library(tidyverse)
fig_2
fig_2_6
fig_2_6 = ggplot() +
geom_col(data = (fig_2_data %>% filter(spp == 'SO')), aes(x = year, y = mean_cal),
colour = 'black', fill = '#23359d', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Sockeye') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
#scale_y_continuous(limits = c(0.0, 0.81))
fig_2 = plot_grid(fig_2_1, fig_2_2, fig_2_3,
fig_2_4, fig_2_5, fig_2_6, nrow = 2, rel_heights = c(0.85, 1), rel_widths = c(1, 0.8, 0.8))
fig_2_6
fig_2_data
fig_2_6 = ggplot() +
geom_col(data = (fig_2_data %>% filter(spp == 'SO')), aes(x = year, y = mean_cal),
colour = 'black', fill = '#23359d', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Sockeye') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
#scale_y_continuous(limits = c(0.0, 0.81))
fig_2 = plot_grid(fig_2_1, fig_2_2, fig_2_3,
fig_2_4, fig_2_5, fig_2_6, nrow = 2, rel_heights = c(0.85, 1), rel_widths = c(1, 0.8, 0.8))
fig_2_6 = ggplot() +
geom_col(data = (fig_2_data %>% filter(spp == 'SO')), aes(x = year, y = mean_cal),
colour = 'black', fill = '#23359d', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Sockeye') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12))
fig_2_6
fig_2_4 = ggplot() +
geom_col(data = (fig_2_data %>% filter(spp == 'PI')), aes(x = year, y = mean_cal),
colour = 'black', fill = '#ff9999', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Pink') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.title.y = element_text(size = 15)) +
theme(axis.text.y = element_text(size = 12)) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
scale_y_continuous(limits = c(0.0, 0.85))
fig_2_5 = ggplot() +
geom_col(data = (fig_2_data %>% filter(spp == 'CU')), aes(x = year, y = mean_cal),
colour = 'black', fill = '#59AE7F', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Chum') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
scale_y_continuous(limits = c(0.0, 0.85))
fig_2_6 = ggplot() +
geom_col(data = (fig_2_data %>% filter(spp == 'SO')), aes(x = year, y = mean_cal),
colour = 'black', fill = '#23359d', width = 0.7) +
labs(x = 'Year', y = cal_y_title, title = 'Sockeye') +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.title.x = element_text(size = 15)) +
theme(axis.text.x = element_text(size = 12)) +
scale_y_continuous(limits = c(0.0, 0.85))
library(cowplot)
fig_2 = plot_grid(fig_2_1, fig_2_2, fig_2_3,
fig_2_4, fig_2_5, fig_2_6, nrow = 2, rel_heights = c(0.85, 1), rel_widths = c(1, 0.8, 0.8))
fig_2
fig_2_data = mainlice %>%
group_by(year, spp) %>%
summarize(mean_cal = mean(all.cal), mean_lep = mean(all.leps))
fig_2_data
mainlice %>% filter(spp == SO) %>% filter(year == 2015) %>% mean(all.cal)
mainlice %>% filter(spp == SO) %>% filter(year == 2015)
test <- read_csv("C:/Users/brookson/Salmon_Work/SalmonWork-master/Hakai_lice_data_CB_edits.csv")
test %>% filter(spp == SO) %>% filter(year == 2015)
test <- read.csv("Hakai_lice_data_CB_edits.csv")
test %>% filter(spp == SO) %>% filter(year == 2015)
test %>% filter(spp == SO) %>% filter(year == 2015) == mainlice %>% filter(spp == SO) %>% filter(year == 2015)
nrow(test %>% filter(spp == SO) %>% filter(year == 2015))
nrow(mainlice %>% filter(spp == SO) %>% filter(year == 2015))
mainlice %>% filter(spp == SO) %>% filter(year == 2015) %>% summarize(all = mean(all.cal))
test %>% filter(spp == SO) %>% filter(year == 2015) %>% summarize(all = mean(all.cal))
test %>% filter(spp == PI) %>% filter(year == 2015) %>% summarize(all = mean(all.cal))
insetmap
fig_3
fig_3
ggsave('lice_per_fish.png', plot = fig_3,
scale = 1, width = 8, height = 6.7,
dpi = 300)
fig_2
ggsave('lice_per_fish_sp.png', plot = fig_2,
width = 8, height = 7.5,
dpi = 300)
insetmap
ggsave('study_map.png', plot = insetmap,
width = 8, height = 7.5,
dpi = 300)
lepsmodplot_avg
ggsave('model_ests_lep.png', plot = lepsmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
calmodplot_avg
ggsave('model_ests_cal.png', plot = calmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
mainlice %>%
filter(spp == PI) %>%
filter(year == 2019) %>%
summary(all = mean(all.cal))
mainlice %>%
filter(spp == PI) %>%
filter(year == 2019) %>%
summarize(all = mean(all.cal))
