facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.9, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.8, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.6, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.7, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.8, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.8, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = lep_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
scale_y_continuous(limits = c(0,1.5), breaks = c(0.5,1.0,1.5))+
fte_theme1()
lepsmodplot_avg
ggsave('model_ests_lep.png', plot = lepsmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.8, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
ggsave('model_ests_cal.png', plot = calmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.7, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Chum', 'Pink', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.7, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Pink', 'Chum', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = lep_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
scale_y_continuous(limits = c(0,1.5), breaks = c(0.5,1.0,1.5))+
fte_theme1()
lepsmodplot_avg
ggsave('model_ests_lep.png', plot = lepsmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.7, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Pink', 'Chum', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
ggsave('model_ests_cal.png', plot = calmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
lepsmodplot_avg
ggsave('model_ests_lep.png', plot = lepsmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.7, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Pink', 'Chum', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
ggsave('model_ests_cal.png', plot = calmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.7, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4.7,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Pink', 'Chum', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = lep_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
scale_y_continuous(limits = c(0,1.5), breaks = c(0.5,1.0,1.5))+
fte_theme1()
lepsmodplot_avg
lepsmodplot_avg <- lepavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.78, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4.7,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_color_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Pink', 'Chum', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = lep_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
scale_y_continuous(limits = c(0,1.5), breaks = c(0.5,1.0,1.5))+
fte_theme1()
lepsmodplot_avg
calmodplot_avg <- calavgpred %>%
group_by(., yr,sal,reg) %>%
ggplot(aes(x = sal, y = avg, colour = sal, shape = reg)) +
scale_shape_manual(values = c(15,17), labels = c('Discovery Islands', 'Johnstone Strait')) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high,width = 0), size = 0.78, position = position_dodge(width = 0.835),colour = 'Black')+
geom_point(size = 4.7,position = position_dodge(width = 0.8)) +
facet_wrap(~yr,nrow=1,strip.position = "bottom")+
theme(strip.background = element_blank(), strip.placement = "outside") +
scale_colour_manual(leg_title,values=c('#ff9999','#59AE7F','#23359d'), labels = c('Pink', 'Chum', 'Sockeye'))+
labs(x = 'Salmon Species/Year', y = cal_y_effects) +
guides(shape = guide_legend(title = 'Region', override.aes = list(shape = c(0,2)), type = 'b')) +
fte_theme1()
calmodplot_avg
ggsave('model_ests_lep.png', plot = lepsmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
ggsave('model_ests_cal.png', plot = calmodplot_avg,
width = 8, height = 7.5,
dpi = 300)
library(tidyverse)
library(cowplot)
library(bbmle)
library(lubridate)
library(rsample)
library(tibble)
library(glmmTMB)
library(ggeffects)
library(DHARMa)
library(MuMIn)
library(here)
library(mapdata)
library(maps)
library(maptools)
library(ggmap)
library(ggrepel)
library(raster)
library(ggthemes)
library(ggsn)
library(rgeos)
library(rgdal)
fte_theme_map_big <- function(){
color.background = 'grey75'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill = 'white', color = 'white')) +
theme(plot.background = element_rect(fill=color.background,color = color.background)) +
theme(panel.border = element_rect(colour = 'black')) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(axis.ticks = element_line(colour = 'black')) +
theme(plot.title = element_blank()) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15))
}
smallermap = ggplot()+
geom_polygon(data=ca.provinces,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-127.0,-125), ylim = c(50,50.75))+
geom_point(data = coords, aes(long,lat), color = 'black', size = 4, shape = 21, fill = 'black')+
fte_theme_map_small()+
labs(x = 'Longitude', y = 'Latitude')+
annotate("rect", xmin = -125.51, xmax = -125.05, ymin = 50.1, ymax = 50.5, alpha = .65)+
annotate("rect", xmin = -126.9, xmax = -126.55, ymin = 50.45, ymax = 50.7, alpha = .65)+
annotate('text', x= -125.8, y = 50.33, label = 'Discovery Islands', size = 4)+
annotate('text', x = -126.6, y = 50.38, label = 'Johnstone Strait', size = 4)+
annotate('segment',x=-125.8, y=50.302, xend=-125.565, yend=50.27, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")+
annotate('segment',x=-126.6, y=50.4, xend=-126.65, yend=50.44, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")
smallermap
biggermap
smallermap = ggplot()+
geom_polygon(data=ca.provinces,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-127.0,-125), ylim = c(50,50.75))+
geom_point(data = coords, aes(long,lat), color = 'black', size = 4, shape = 21, fill = 'black')+
fte_theme_map_small()+
labs(x = 'Longitude', y = 'Latitude')+
annotate("rect", xmin = -125.51, xmax = -125.05, ymin = 50.1, ymax = 50.5, alpha = .65)+
annotate("rect", xmin = -126.9, xmax = -126.55, ymin = 50.45, ymax = 50.7, alpha = .65)+
annotate('text', x= -125.8, y = 50.33, label = 'Discovery Islands', size = 4)+
annotate('text', x = -126.6, y = 50.38, label = 'Johnstone Strait', size = 4)+
annotate('segment',x=-125.8, y=50.302, xend=-125.565, yend=50.27, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")+
annotate('segment',x=-126.6, y=50.4, xend=-126.65, yend=50.44, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.8, color="black")
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.8, color="black")
biggermap
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.5, "npc")),
alpha = 0.8, size=1.8, color="black")
biggermap
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.1, "npc")),
alpha = 0.8, size=1.8, color="black")
biggermap
#make two themes, one for the inset, one for the big map
fte_theme_map_small <- function(){
color.background = 'white'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill=color.background,color = color.background)) +
theme(plot.background = element_rect(fill = color.background, color = color.background)) +
theme(panel.border = element_rect(colour = 'black')) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_text(size = 12, color = color.axis.text, angle = 90)) +
theme(axis.text.y = element_text(size = 12, color = color.axis.text)) +
theme(axis.title.x = element_text(size = 14, color = color.axis.title, vjust = 0)) +
theme(axis.title.y = element_text(size = 14, color = color.axis.title, vjust = 1.25)) +
theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.ticks = element_line(colour = 'black')) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15))
}
fte_theme_map_big <- function(){
color.background = 'grey75'
color.grid.major = 'black'
color.axis.text = 'black'
color.axis.title = 'black'
color.title = 'black'
theme_bw(base_size = 9) +
theme(panel.background = element_rect(fill = 'white', color = 'white')) +
theme(plot.background = element_rect(fill=color.background,color = color.background)) +
theme(panel.border = element_rect(colour = 'black')) +
theme(panel.grid.major = element_blank()) +
theme(panel.grid.minor = element_blank()) +
theme(axis.ticks = element_blank()) +
theme(plot.title = element_text(color = color.title, size = 15, vjust = 1.25)) +
theme(axis.text.x = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(plot.title = element_blank()) +
theme(axis.line.x = element_line(color="black", size = 0.15),
axis.line.y = element_line(color="black", size = 0.15))
}
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.1, "npc")),
alpha = 0.8, size=1.8, color="black")
smallermap = ggplot()+
geom_polygon(data=ca.provinces,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-127.0,-125), ylim = c(50,50.75))+
geom_point(data = coords, aes(long,lat), color = 'black', size = 4, shape = 21, fill = 'black')+
fte_theme_map_small()+
labs(x = 'Longitude', y = 'Latitude')+
annotate("rect", xmin = -125.51, xmax = -125.05, ymin = 50.1, ymax = 50.5, alpha = .65)+
annotate("rect", xmin = -126.9, xmax = -126.55, ymin = 50.45, ymax = 50.7, alpha = .65)+
annotate('text', x= -125.8, y = 50.33, label = 'Discovery Islands', size = 4)+
annotate('text', x = -126.6, y = 50.38, label = 'Johnstone Strait', size = 4)+
annotate('segment',x=-125.8, y=50.302, xend=-125.565, yend=50.27, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")+
annotate('segment',x=-126.6, y=50.4, xend=-126.65, yend=50.44, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")
#make the one plot inset with the other
insetmap = ggdraw()+
draw_plot(smallermap) +
draw_plot(biggermap, x=0.105, y=0.161, width=0.5, height=0.3)
insetmap
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.16, "npc")),
alpha = 0.8, size=1.5, color="black")
insetmap = ggdraw()+
draw_plot(smallermap) +
draw_plot(biggermap, x=0.105, y=0.161, width=0.5, height=0.3)
insetmap
ggsave('study_map.png', plot = insetmap,
width = 8, height = 7.5,
dpi = 300)
biggermap = ggplot()+
geom_polygon(data = us.states,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
geom_polygon(data=ca.provinces, aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-128.5,-119.5), ylim = c(48.1,51.0)) +
fte_theme_map_big()+
annotate("rect", xmin = -127.3, xmax = -125, ymin = 49.8, ymax = 50.9, alpha = .7)+
annotate('text', x = -121, y = 50.7, label = 'British Columbia', size = 4)+
annotate('text', x = -120.7, y = 48.5, label = 'Washington', size = 4)+
annotate('text', x = -126.7, y = 48.5, label = 'Vancouver Island', size = 4)+
annotate('segment',x=-126.7, y=48.6, xend=-125.5, yend=49.5, arrow=arrow(length = unit(0.16, "npc")),
alpha = 0.8, size=1.2, color="black")
insetmap = ggdraw()+
draw_plot(smallermap) +
draw_plot(biggermap, x=0.105, y=0.161, width=0.5, height=0.3)
insetmap
ggsave('study_map.png', plot = insetmap,
width = 8, height = 7.5,
dpi = 300)
smallermap = ggplot()+
geom_polygon(data=ca.provinces,aes(x=long,y=lat,group=group), colour = 'black', size = 0.01, fill = 'grey75')+
coord_cartesian(xlim = c(-127.0,-125), ylim = c(50,50.75))+
fte_theme_map_small()+
labs(x = 'Longitude', y = 'Latitude')+
annotate("rect", xmin = -125.51, xmax = -125.05, ymin = 50.1, ymax = 50.5, alpha = .65)+
annotate("rect", xmin = -126.9, xmax = -126.55, ymin = 50.45, ymax = 50.7, alpha = .65)+
annotate('text', x= -125.8, y = 50.33, label = 'Discovery Islands', size = 4)+
annotate('text', x = -126.6, y = 50.38, label = 'Johnstone Strait', size = 4)+
geom_point(data = coords, aes(long,lat), color = 'black', size = 4, shape = 21, fill = 'black')+
annotate('segment',x=-125.8, y=50.302, xend=-125.565, yend=50.27, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")+
annotate('segment',x=-126.6, y=50.4, xend=-126.65, yend=50.44, arrow=arrow(length = unit(0.04, "npc")),
alpha = 0.8, size=1.1, color="black")
insetmap = ggdraw()+
draw_plot(smallermap) +
draw_plot(biggermap, x=0.105, y=0.161, width=0.5, height=0.3)
insetmap
ggsave('study_map.png', plot = insetmap,
width = 8, height = 7.5,
dpi = 300)
mainlice %>% filter(spp == 'PI') %>% summarize(mean = mean(all.leps))
mainlice %>% filter(spp == 'PI') %>% summarize(mean = mean(all.leps), sd = sd(all.leps))
mainlice %>% filter(spp == 'PI') %>% summarize(mean = mean(all.leps), sd = sd(all.cal))
mainlice %>% filter(spp == 'PI') %>% summarize(mean = mean(all.cal), sd = sd(all.cal))
mainlice %>% filter(spp == 'CU') %>% summarize(mean = mean(all.leps), sd = sd(all.leps))
mainlice %>% filter(spp == 'SO') %>% summarize(mean = mean(all.leps), sd = sd(all.leps))
mainlice %>% filter(spp == 'SO') %>% summarize(mean = mean(all.cal), sd = sd(all.cal))
mainlice %>% filter(spp == 'CU') %>% summarize(mean = mean(all.cal), sd = sd(all.cal))
mainlice %>% filter(spp == 'PI') %>% summarize(mean = mean(all.cal), sd = sd(all.cal))
version()
R.version()
R -- version
R.Version()
mean(all.cal)
mean(mainlice$all.cal)
mean(mainlice$all.leps)
mean(mainlice$all.cal)/mean(mainlice$all.leps)
calmodplot_avg
lepsmodplot_avg
calavgpred$avg > calavgpred$avg
calavgpred$avg > lepavgpred$avg
View(lep_top_effects)
View(calavgpred)
View(lepavgpred)
1	7.075507e-01
7.075507e-01
3.610202e-01
calmodplot_avg
lepsmodplot_avg
calmodplot_avg
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2019))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2017))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2015))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2016))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2017))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2018))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2018))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2019))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2017))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2016))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2015))
nrow(mainlice %>% filter(spp == 'CU') %>% filter(year == 2015))
nrow(mainlice %>% filter(spp == 'CU') %>% filter(year == 2016))
nrow(mainlice %>% filter(spp == 'CU') %>% filter(year == 2017))
nrow(mainlice %>% filter(spp == 'CU') %>% filter(year == 2018))
nrow(mainlice %>% filter(spp == 'CU') %>% filter(year == 2019))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2019) %>% filter(site.region == 'DI'))
nrow(mainlice %>% filter(spp == 'PI') %>% filter(year == 2019) %>% filter(site.region == 'JS'))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2019) %>% filter(site.region == 'JS'))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2019) %>% filter(site.region == 'J'))
nrow(mainlice %>% filter(spp == 'SO') %>% filter(year == 2019) %>% filter(site.region == 'D'))
